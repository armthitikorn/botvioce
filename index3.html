
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Roleplay Test</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet"/>
  <style>
    body {
      margin: 0;
      font-family: 'Prompt', sans-serif;
      background: linear-gradient(-45deg, #74ebd5, #9face6, #a18cd1, #fbc2eb);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
    }
    @keyframes gradientBG {
      0% {background-position: 0% 50%;}
      50% {background-position: 100% 50%;}
      100% {background-position: 0% 50%;}
    }
    .card {
      animation: fadeIn 1s ease-in-out;
      border-radius: 1rem;
    }
    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(20px);}
      to {opacity: 1; transform: translateY(0);}
    }
    .btn-animated {
      transition: all 0.3s ease;
    }
    .btn-animated:hover {
      transform: scale(1.05);
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }
    .question-section {
      display: none;
      animation: fadeIn 0.5s ease-in-out;
    }
    .question-list {
      max-height: 400px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <div class="container py-5">
    <div class="card shadow-lg p-4 mx-auto" style="max-width: 700px;">
      <h3 class="text-center mb-4 text-primary">แบบทดสอบ Roleplay</h3>
      <div id="mainMenu">
        <p class="text-center">กรุณาเลือกส่วนที่ต้องการเริ่มต้น</p>
        <div class="d-grid gap-3">
          <button class="btn btn-primary btn-animated" onclick="showPart('part1')"><i class="bi bi-play-circle"></i> เริ่มส่วนที่ 1</button>
          <button class="btn btn-primary btn-animated" onclick="showPart('part2')"><i class="bi bi-play-circle"></i> เริ่มส่วนที่ 2</button>
          <button class="btn btn-primary btn-animated" onclick="showPart('part3')"><i class="bi bi-play-circle"></i> เริ่มส่วนที่ 3</button>
        </div>
      </div>

      <div id="part1" class="question-section mt-4">
        <h5 class="text-secondary">ส่วนที่ 1: โน้มน้าวเมื่อลูกค้าปฏิเสธต้นสาย</h5>
        <ul class="list-group question-list mt-3" id="list-part1"></ul>
        <div class="mt-3 d-flex gap-2 flex-wrap">
          <button id="startRecord" class="btn btn-danger btn-animated"><i class="bi bi-mic-fill"></i> เริ่มบันทึกเสียง</button>
          <button id="stopRecord" class="btn btn-secondary btn-animated" disabled><i class="bi bi-stop-circle"></i> หยุดบันทึก</button>
          <a id="downloadAudio" class="btn btn-success btn-animated" style="display:none;"><i class="bi bi-download"></i> ดาวน์โหลดเสียง</a>
          <button class="btn btn-outline-dark ms-auto btn-animated" onclick="goBack()"><i class="bi bi-arrow-left"></i> ย้อนกลับ</button>
        </div>
      </div>

      <div id="part2" class="question-section mt-4">
        <h5 class="text-secondary">ส่วนที่ 2: ตอบข้อโต้แย้งเกี่ยวกับความคุ้มครอง</h5>
        <ul class="list-group question-list mt-3" id="list-part2"></ul>
        <div class="mt-3 d-flex gap-2 flex-wrap">
          <button id="startRecord2" class="btn btn-danger btn-animated"><i class="bi bi-mic-fill"></i> เริ่มบันทึกเสียง</button>
          <button id="stopRecord2" class="btn btn-secondary btn-animated" disabled><i class="bi bi-stop-circle"></i> หยุดบันทึก</button>
          <a id="downloadAudio2" class="btn btn-success btn-animated" style="display:none;"><i class="bi bi-download"></i> ดาวน์โหลดเสียง</a>
          <button class="btn btn-outline-dark ms-auto btn-animated" onclick="goBack()"><i class="bi bi-arrow-left"></i> ย้อนกลับ</button>
        </div>
      </div>

      <div id="part3" class="question-section mt-4">
        <h5 class="text-secondary">ส่วนที่ 3: ปิดการขายเมื่อลูกค้าลังเล</h5>
        <ul class="list-group question-list mt-3" id="list-part3"></ul>
        <div class="mt-3 d-flex gap-2 flex-wrap">
          <button id="startRecord3" class="btn btn-danger btn-animated"><i class="bi bi-mic-fill"></i> เริ่มบันทึกเสียง</button>
          <button id="stopRecord3" class="btn btn-secondary btn-animated" disabled><i class="bi bi-stop-circle"></i> หยุดบันทึก</button>
          <a id="downloadAudio3" class="btn btn-success btn-animated" style="display:none;"><i class="bi bi-download"></i> ดาวน์โหลดเสียง</a>
          <button class="btn btn-outline-dark ms-auto btn-animated" onclick="goBack()"><i class="bi bi-arrow-left"></i> ย้อนกลับ</button>
        </div>
      </div>
    </div>
  </div>

<script>
const questions = {
  part1: [
    "ขอโทษครับ/ค่ะ ไม่สนใจต้นสาย", "ไม่สะดวกคุยตอนนี้ครับ/ค่ะ", "ไม่รับสายขายของครับ/ค่ะ", "ไม่สนใจประกันครับ/ค่ะ",
    "มีประกันอยู่แล้วครับ/ค่ะ", "ไม่อยากเสียเวลา", "ไม่เคยซื้อของทางโทรศัพท์", "ไม่ไว้ใจการขายทางโทรศัพท์",
    "ไม่อยากให้ข้อมูลส่วนตัว", "ไม่สนใจเรื่องสุขภาพตอนนี้", "ไม่สะดวกทำงานอยู่", "ไม่สะดวกขับรถอยู่",
    "ไม่สะดวกคุยช่วงเช้า", "ไม่สะดวกโทรมาบ่อยมาก", "ไม่สะดวก ไม่ฟัง", "ประกันมีเยอะแล้ว",
    "ใครให้เบอร์โทรมาติดต่อ", "ยกเลิกบัตรเครดิตไปแล้ว", "ไม่ชอบประกันชีวิต", "ยกเลิกไปหมดแล้ว", "มิจฉาชีพหรือป่าว"
  ],
  part2: [
    "ประกันสุขภาพครอบคลุมโรคเรื้อรังหรือไม่?", "ถ้าเข้าโรงพยาบาลเอกชนจะจ่ายเต็มไหม?", "มีค่าห้องสูงสุดเท่าไหร่?",
    "ต้องสำรองจ่ายก่อนหรือไม่?", "มีเงื่อนไขการเคลมอะไรบ้าง?", "ถ้าเป็นโรคที่มีมาก่อนจะคุ้มครองไหม?",
    "มีระยะเวลารอคอยหรือไม่?", "เบี้ยประกันปรับขึ้นทุกปีหรือไม่?", "สามารถใช้ร่วมกับสิทธิ์ประกันสังคมได้ไหม?",
    "มีวงเงินคุ้มครองสูงสุดเท่าไหร่?", "ถ้าไม่ได้ใช้บริการเลย จะได้เงินคืนไหม?", "มีบริการเคลมออนไลน์หรือไม่?",
    "สามารถเลือกโรงพยาบาลเองได้ไหม?", "มีคุ้มครองกรณีอุบัติเหตุหรือไม่?", "ถ้าเปลี่ยนงานจะยังใช้ประกันได้ไหม?",
    "มีคุ้มครองกรณีโรคร้ายแรงหรือไม่?", "สามารถซื้อให้ครอบครัวได้ไหม?", "มีบริการช่วยเหลือฉุกเฉินหรือไม่?",
    "มีเงื่อนไขการยกเลิกกรมธรรม์อย่างไร?", "สามารถจ่ายเบี้ยผ่านบัตรเครดิตได้ไหม?", "ข้อมูลเยอะจัง ส่งเอกสารให้ดูก่อนได้มัย",
    "เหมือนที่มีอยู่ เหมือนๆกันเลย", "ความคุ้มครองน้อยจัง ไม่ตอบโจทย์", "ค่าเบี้ยแพงจัง", "ไม่อยากได้แบบนี้ อยากได้แบบอื่น",
    "ขอปรึกษาพ่อ แม่ แฟน ดูก่อน", "ช่วงนี้ค่าใช้จ่ายเยอะ", "ขอคิดดูก่อน", "กลัวซ้ำซ้อน เบิกเคลมไม่ได้",
    "มีเยอะแล้ว แค่ฟังๆดูก่อน", "ทำแล้วติดต่อยาก ไม่รู้จะปรึกษาใครเวลามีปัญหาในกรมธรรม์", "ที่พูดมาได้จริงหรอ",
    "ไม่มั่นใจในบริษัท ไม่ชอบซื้อผ่านโทรศัพท์", "ได้กำไรน้อย ขาดทุน กว่าจะได้จุดคุ้มทุน", "ซื้อไปก็ไม่ได้ใช้",
    "เดียวๆ ต้องทำงานต่อก่อน", "ฟังแล้วไม่น่าสนใจเลย", "มีประกันสังคม ประกันกลุ่มบริษัทอยู่แล้ว",
    "หักลดหย่อนภาษีเต็ม", "ที่บ้านเป็นตัวแทน", "ซื้อไว้หมดทุกตัวแล้ว"
  ],
  part3: [
    "คิดว่าแพงเกินไปครับ/ค่ะ", "ขอคิดดูก่อนครับ/ค่ะ", "ต้องปรึกษาครอบครัวก่อนครับ/ค่ะ", "ยังไม่พร้อมตัดสินใจครับ/ค่ะ",
    "ไม่มั่นใจในบริษัทครับ/ค่ะ", "กลัวถูกหลอกครับ/ค่ะ", "มีประกันอยู่แล้วครับ/ค่ะ", "ไม่เห็นความจำเป็นครับ/ค่ะ",
    "ไม่อยากผูกมัดระยะยาวครับ/ค่ะ", "ไม่มั่นใจว่าจะได้ใช้ครับ/ค่ะ", "ยังๆ ยังไม่ทำนะ",
    "ขอดูวงเงินบัตรเครดิตก่อน รอบตัดบัตรเครดิตไม่สะดวก", "ต้องทำเลยหรอ", "คิดดูก่อนสักวัน 2วันได้มัย",
    "ขอเปรียบเทียบกับกรมธรรม์เก่าก่อนนะ", "ยังไม่ให้คำตอบวันนี้", "โยนให้คนอื่นตัดสิ้นใจแทน เช่น แฟน", "รอเงินเดือนออกก่อน"
  ]
};

function showPart(partId) {
  document.getElementById("mainMenu").style.display = "none";
  document.querySelectorAll(".question-section").forEach(el => el.style.display = "none");
  const section = document.getElementById(partId);
  section.style.display = "block";

  const list = document.getElementById("list-" + partId);
  list.innerHTML = "";
  questions[partId].slice(0, 10).forEach((q, i) => {
    const li = document.createElement("li");
    li.className = "list-group-item";
    li.textContent = (i + 1) + ". " + q;
    list.appendChild(li);
  });
}

function goBack() {
  document.getElementById("mainMenu").style.display = "block";
  document.querySelectorAll(".question-section").forEach(el => el.style.display = "none");
}

// Voice recording logic for each part
function setupRecorder(startId, stopId, downloadId) {
  let mediaRecorder;
  let chunks = [];

  const startBtn = document.getElementById(startId);
  const stopBtn = document.getElementById(stopId);
  const downloadLink = document.getElementById(downloadId);

  startBtn.addEventListener("click", async () => {
    chunks = [];
    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
    mediaRecorder = new MediaRecorder(stream);

    mediaRecorder.ondataavailable = e => {
      if (e.data.size > 0) chunks.push(e.data);
    };

    mediaRecorder.onstop = () => {
      const blob = new Blob(chunks, { type: "audio/webm" });
      const url = URL.createObjectURL(blob);
      downloadLink.href = url;
      downloadLink.download = "recorded_audio.webm";
      downloadLink.style.display = "inline-block";
    };

    mediaRecorder.start();
    startBtn.disabled = true;
    stopBtn.disabled = false;
  });

  stopBtn.addEventListener("click", () => {
    mediaRecorder.stop();
    startBtn.disabled = false;
    stopBtn.disabled = true;
  });
}

setupRecorder("startRecord", "stopRecord", "downloadAudio");
setupRecorder("startRecord2", "stopRecord2", "downloadAudio2");
setupRecorder("startRecord3", "stopRecord3", "downloadAudio3");
</script>
</body>
</html>
